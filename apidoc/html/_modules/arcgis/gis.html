<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>arcgis.gis &mdash; arcgis 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="arcgis 0.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          arcgis</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../arcgis.html">arcgis package</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <h1>Source code for arcgis.gis</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The **gis** module provides an information model for GIS hosted </span>
<span class="sd">within ArcGIS Online or an ArcGIS Portal. This module provides functionality to manage </span>
<span class="sd">(create, read, update and delete) GIS users, groups, content and datastores. This module</span>
<span class="sd">is the most important and provides the entry point into the GIS.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">arcgis._impl.portalpy</span> <span class="kn">as</span> <span class="nn">portalpy</span>
<span class="kn">from</span> <span class="nn">arcgis.tools</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">arcgis.lyr</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">base64</span>

<span class="kn">from</span> <span class="nn">pydoc</span> <span class="kn">import</span> <span class="n">locate</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">locale</span>

<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">urllib.error</span>
<span class="c"># pylint: disable=fixme, line-too-long</span>


<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">_tempinput</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&#39;UTF-8&#39;</span><span class="p">)))</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">yield</span> <span class="n">temp</span><span class="o">.</span><span class="n">name</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_lazy_property</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Decorator that makes a property lazy-evaluated.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c"># http://stevenloria.com/lazy-evaluated-properties-in-python/</span>
    <span class="n">attr_name</span> <span class="o">=</span> <span class="s">&#39;_lazy_&#39;</span> <span class="o">+</span> <span class="n">fn</span><span class="o">.</span><span class="n">__name__</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_lazy_property</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_lazy_property</span>

<div class="viewcode-block" id="GIS"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS">[docs]</a><span class="k">class</span> <span class="nc">GIS</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. _gis:</span>

<span class="sd">    **************</span>
<span class="sd">    The GIS object</span>
<span class="sd">    **************</span>
<span class="sd">    A GIS is representative of ArcGIS Online or an ArcGIS Portal</span>
<span class="sd">    site. The GIS object provides helper objects to manage (search, create, retrieve) GIS resources:</span>
<span class="sd">    * users</span>
<span class="sd">    * groups</span>
<span class="sd">    * content</span>
<span class="sd">    * datastore</span>
<span class="sd">    * tools - including geometry, geocoder, analysis, rasters, geoanalytics </span>

<span class="sd">    Additionally, the GIS object has properties and methods to query it&#39;s state:</span>
<span class="sd">    * properties</span>
<span class="sd">    * usage()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_version</span> <span class="o">=</span> <span class="s">&#39;0.1&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">key_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cert_file</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a GIS object given a url and user credentials to ArcGIS Online </span>
<span class="sd">        or an ArcGIS Portal. User credentials can be passed in using username/password</span>
<span class="sd">        pair, or key_file/cert_file pair (in case of PKI). Supports built-in users, LDAP,</span>
<span class="sd">        PKI and Anonymous access.</span>

<span class="sd">        If no url is provided, ArcGIS Online is used. If username/password</span>
<span class="sd">        or key/cert files are not provided, anonymous access is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://www.arcgis.com&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_file</span> <span class="o">=</span> <span class="n">key_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cert_file</span> <span class="o">=</span> <span class="n">cert_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tools</span> <span class="o">=</span> <span class="n">Tools</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__enter__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portalpy</span><span class="o">.</span><span class="n">Portal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_password</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cert_file</span><span class="p">)</span>
        
    <span class="nd">@_lazy_property</span>
<div class="viewcode-block" id="GIS.users"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS.users">[docs]</a>    <span class="k">def</span> <span class="nf">users</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The resource manager for GIS users</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">UserManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">)</span>
</div>
    <span class="nd">@_lazy_property</span>
<div class="viewcode-block" id="GIS.groups"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS.groups">[docs]</a>    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The resource manager for GIS groups</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">GroupManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">)</span>
</div>
    <span class="nd">@_lazy_property</span>
<div class="viewcode-block" id="GIS.content"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS.content">[docs]</a>    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The resource manager for GIS content</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ContentManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">)</span>
</div>
    <span class="nd">@_lazy_property</span>
<div class="viewcode-block" id="GIS.datastore"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS.datastore">[docs]</a>    <span class="k">def</span> <span class="nf">datastore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The resource manager for the GIS data store</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fedservers_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">+</span> <span class="s">&quot;/portaladmin/federation/servers?f=json&quot;</span>
        <span class="c">#print(fedservers_url)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fedservers_url</span><span class="p">)</span>
        <span class="n">servers</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;servers&#39;</span><span class="p">]</span>

        <span class="n">admin_url</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">servers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;isHosted&#39;</span><span class="p">]:</span> 
                <span class="n">admin_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;adminUrl&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;/admin&#39;</span>
                <span class="k">return</span> <span class="n">DatastoreManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">admin_url</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">None</span>
</div>
    <span class="nd">@_lazy_property</span>
<div class="viewcode-block" id="GIS.properties"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS.properties">[docs]</a>    <span class="k">def</span> <span class="nf">properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The properties of the GIS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_properties</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;GIS @ &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        HTML Representation for IPython Notebook</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&#39;GIS @ &lt;a href=&quot;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">+</span> <span class="s">&#39;&quot;&gt;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url</span> <span class="o">+</span> <span class="s">&#39;&lt;/a&gt;&#39;</span>

    <span class="k">def</span> <span class="nf">_get_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the portal properties (using cache unless force=True). &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_properties</span><span class="p">(</span><span class="n">force</span><span class="p">)</span>

    <span class="c">#def usage(self, startTime, endTime, period, vars, etype, stype, groupby, appId=None):</span>
    <span class="c">#    &quot;&quot;&quot;Usage statistics for the GIS&quot;&quot;&quot;</span>
    <span class="c">#    return self._portal.usage(startTime, endTime, period, vars, etype, stype, groupby, appId)</span>

<div class="viewcode-block" id="GIS.map"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GIS.map">[docs]</a>    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zoomlevel</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a map widget centered at the location (Address or (lat, long) tuple) with the specified zoom-level(integer)&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">arcgis.viz</span> <span class="kn">import</span> <span class="n">MapView</span>
        <span class="n">mapwidget</span> <span class="o">=</span> <span class="n">MapView</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">mapwidget</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">geocoder</span><span class="o">.</span><span class="n">find_best_match</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">mapwidget</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">location</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;location must be an address(string) or (lat, long) pair as a tuple&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zoomlevel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mapwidget</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoomlevel</span>

        <span class="k">return</span> <span class="n">mapwidget</span>

    </div></div>
<div class="viewcode-block" id="DatastoreItem"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem">[docs]</a><span class="k">class</span> <span class="nc">DatastoreItem</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a datastore item (folder, database or bigdata fileshare) within the GIS&#39;s data store</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datastore</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datastore</span> <span class="o">=</span> <span class="n">datastore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">_portal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">=</span> <span class="n">datastore</span><span class="o">.</span><span class="n">_admin_url</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span> <span class="o">=</span> <span class="n">path</span>

        
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/items&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span>

        <span class="n">datadict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
 
        <span class="k">if</span> <span class="n">datadict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">datadict</span><span class="p">)</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">datadict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="c"># support group attributes as group.access, group.owner, group.phone etc</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="c"># support group attributes as dictionary keys on this object, eg. group[&#39;owner&#39;]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">}</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/items&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span>

            <span class="n">datadict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">datadict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">datadict</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;   </span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s"> title:&quot;</span><span class="si">%s</span><span class="s">&quot; type:&quot;</span><span class="si">%s</span><span class="s">&quot;&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">manifest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The manifest resource for bigdata fileshares, </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_item_manifest_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/items&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span> <span class="o">+</span> <span class="s">&quot;/manifest&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">data_item_manifest_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@manifest.setter</span>
<div class="viewcode-block" id="DatastoreItem.manifest"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem.manifest">[docs]</a>    <span class="k">def</span> <span class="nf">manifest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the manifest resource for bigdata fileshares, </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">manifest_upload_url</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/items&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span> <span class="o">+</span> <span class="s">&#39;/manifest/update&#39;</span>

        <span class="k">with</span> <span class="n">_tempinput</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">as</span> <span class="n">tempfilename</span><span class="p">:</span>
            <span class="c"># Build the files list (tuples)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;manifest&#39;</span><span class="p">,</span> <span class="n">tempfilename</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">tempfilename</span><span class="p">)))</span>
                
            <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&#39;f&#39;</span> <span class="p">:</span> <span class="s">&#39;pjson&#39;</span>
            <span class="p">}</span>
                
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">manifest_upload_url</span><span class="p">,</span> <span class="n">postdata</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
    
            <span class="k">if</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">resp</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">False</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="DatastoreItem.ref_count"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem.ref_count">[docs]</a>    <span class="k">def</span> <span class="nf">ref_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The total number of references to this data item that exist on the server. You can use this property to determine if this data item can be safely deleted (or taken down for maintenance).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_item_manifest_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/computeTotalRefCount&#39;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
            <span class="s">&#39;itemPath&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">data_item_manifest_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s">&quot;totalRefCount&quot;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="DatastoreItem.delete"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unregisters this data item from the data store</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> 
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">,</span>
            <span class="s">&quot;itempath&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span><span class="p">,</span>
            <span class="s">&quot;force&quot;</span><span class="p">:</span> <span class="bp">True</span>
            <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/unregisterItem&quot;</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;success&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="DatastoreItem.update"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edits this data item to update its connection information.</span>
<span class="sd">        </span>
<span class="sd">        Input</span>
<span class="sd">            item - the dict representation of the updated item</span>
<span class="sd">        Output:</span>
<span class="sd">              True if successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> 
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">,</span>
            <span class="s">&quot;item&quot;</span> <span class="p">:</span> <span class="n">item</span>
            <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span>  <span class="s">&quot;/data/items&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span> <span class="o">+</span>  <span class="s">&quot;/edit&quot;</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span> <span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="DatastoreItem.validate"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates that this data item&#39;s path (for file shares) or connection string (for databases) </span>
<span class="sd">        is accessible to every server node in the site</span>
<span class="sd">        </span>
<span class="sd">        Output:</span>
<span class="sd">              True if successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/items&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span>

        <span class="n">datadict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;item&quot;</span><span class="p">:</span> <span class="n">datadict</span>
            <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/validateDataItem&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span>
</div>
<div class="viewcode-block" id="DatastoreItem.list_datasets"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreItem.list_datasets">[docs]</a>    <span class="k">def</span> <span class="nf">list_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists the datasets in a big data file share.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_item_manifest_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/items&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span> <span class="o">+</span> <span class="s">&quot;/manifest&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">data_item_manifest_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;datasets&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;/server/datastores&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">datapath</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">&#39;path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39; (&#39;</span><span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="DatastoreManager"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager">[docs]</a><span class="k">class</span> <span class="nc">DatastoreManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manager class for managing the GIS data stores in on-premises ArcGIS Portals.</span>
<span class="sd">    This class is not created by users directly.</span>
<span class="sd">    An instance of this class, called &#39;datastores&#39;, is available as a property of the GIS object.</span>
<span class="sd">    Users call methods on this &#39;datastores&#39; object to manage the data stores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gis</span><span class="p">,</span> <span class="n">admin_url</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span> <span class="o">=</span> <span class="n">gis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">gis</span><span class="o">.</span><span class="n">_portal</span>
        <span class="k">if</span> <span class="n">admin_url</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fedservers_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">_url</span> <span class="o">+</span> <span class="s">&quot;portaladmin/federation/servers?f=json&quot;</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fedservers_url</span><span class="p">)</span>
            <span class="n">servers</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;servers&#39;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">servers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;isHosted&#39;</span><span class="p">]:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">=</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;adminUrl&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;/admin&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">=</span> <span class="n">admin_url</span>
           
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The data store configuration properties affect the behavior of the data holdings of the server. The properties include:</span>
<span class="sd">        blockDataCopy—When this property is False, or not set at all, copying data to the site when publishing services from a client application is allowed. This is the default behavior. </span>
<span class="sd">        When this property is True, the client application is not allowed to copy data to the site when publishing. Rather, the publisher is required to register data items through which the service being published can reference data. Values: True | False</span>
<span class="sd">        Note:</span>
<span class="sd">        If you specify the property as True, users will not be able to publish geoprocessing services and geocode services from composite locators. These service types require data to be copied to the server. As a workaround, you can temporarily set the property to False, publish the service, and then set the property back to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/config&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@config.setter</span>
<div class="viewcode-block" id="DatastoreManager.config"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The data store configuration properties affect the behavior of the data holdings of the server. The properties include:</span>
<span class="sd">        blockDataCopy—When this property is False, or not set at all, copying data to the site when publishing services from a client application is allowed. This is the default behavior. </span>
<span class="sd">        When this property is True, the client application is not allowed to copy data to the site when publishing. Rather, the publisher is required to register data items through which the service being published can reference data. Values: True | False</span>
<span class="sd">        Note:</span>
<span class="sd">        If you specify the property as True, users will not be able to publish geoprocessing services and geocode services from composite locators. These service types require data to be copied to the server. As a workaround, you can temporarily set the property to False, publish the service, and then set the property back to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">}</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&#39;datastoreConfig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/config/update&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
           </div>
<div class="viewcode-block" id="DatastoreManager.add_folder"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.add_folder">[docs]</a>    <span class="k">def</span> <span class="nf">add_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">server_path</span><span class="p">,</span>
            <span class="n">client_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a folder with the data store.</span>
<span class="sd">        Input</span>
<span class="sd">            name - unique fileshare name on the server</span>
<span class="sd">            server_path - the path to the folder from the server (and client, if shared path)</span>
<span class="sd">            client_path - if folder is replicated, the path to the folder from the client</span>
<span class="sd">            if folder is shared, don&#39;t set this parameter</span>
<span class="sd">        Output:</span>
<span class="sd">              the data item is registered successfully, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conn_type</span> <span class="o">=</span> <span class="s">&quot;shared&quot;</span>
        <span class="k">if</span> <span class="n">client_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">conn_type</span> <span class="o">=</span> <span class="s">&quot;replicated&quot;</span>

        <span class="n">item</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;type&quot;</span> <span class="p">:</span> <span class="s">&quot;folder&quot;</span><span class="p">,</span>
                <span class="s">&quot;path&quot;</span> <span class="p">:</span> <span class="s">&quot;/fileShares/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span>
                <span class="s">&quot;info&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;path&quot;</span> <span class="p">:</span> <span class="n">server_path</span><span class="p">,</span>
                    <span class="s">&quot;dataStoreConnectionType&quot;</span> <span class="p">:</span> <span class="n">conn_type</span>
                    <span class="p">}</span>
                <span class="p">}</span>

        <span class="k">if</span> <span class="n">client_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">item</span><span class="p">[</span><span class="s">&#39;clientPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_path</span>
            
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;item&quot;</span> <span class="p">:</span> <span class="n">item</span>
        <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/registerItem&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span> <span class="ow">or</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DatastoreItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;/fileShares/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="DatastoreManager.add_bigdata"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.add_bigdata">[docs]</a>    <span class="k">def</span> <span class="nf">add_bigdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">server_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a bigdata fileshare with the data store.</span>
<span class="sd">        Input</span>
<span class="sd">            name - unique bigdata fileshare name on the server</span>
<span class="sd">            server_path - the path to the folder from the server </span>
<span class="sd">        Output:</span>
<span class="sd">              the data item if registered successfully, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/registerItem&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
            <span class="s">&#39;item&#39;</span> <span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="s">&quot;/bigDataFileShares/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span>
              <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;bigDataFileShare&quot;</span><span class="p">,</span>
              <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;path&quot;</span> <span class="p">:</span> <span class="n">server_path</span>
               <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span> <span class="ow">or</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">DatastoreItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;/bigDataFileShares/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;success&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Created Big Data file share for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Big Data file share exists for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span>
</div>
<div class="viewcode-block" id="DatastoreManager.add_database"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.add_database">[docs]</a>    <span class="k">def</span> <span class="nf">add_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">conn_str</span><span class="p">,</span>
            <span class="n">client_conn_str</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">conn_type</span><span class="o">=</span><span class="s">&quot;shared&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a database with the data store.</span>
<span class="sd">        Input</span>
<span class="sd">            name - unique database name on the server</span>
<span class="sd">            conn_str - the path to the folder from the server (and client, if shared or serverOnly database)</span>
<span class="sd">            client_conn_str: connection string for client to connect to replicated enterprise database&gt;</span>
<span class="sd">            conn_type - &quot;&lt;shared|replicated|serverOnly&gt;&quot;</span>
<span class="sd">        Output:</span>
<span class="sd">            the data item is registered successfully, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">item</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;type&quot;</span> <span class="p">:</span> <span class="s">&quot;egdb&quot;</span><span class="p">,</span>
                <span class="s">&quot;path&quot;</span> <span class="p">:</span> <span class="s">&quot;/enterpriseDatabases/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span>
                <span class="s">&quot;info&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;connectionString&quot;</span> <span class="p">:</span> <span class="n">conn_str</span><span class="p">,</span>
                    <span class="s">&quot;dataStoreConnectionType&quot;</span> <span class="p">:</span> <span class="n">conn_type</span>
                    <span class="p">}</span>
                <span class="p">}</span>

        <span class="k">if</span> <span class="n">client_conn_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">item</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">][</span><span class="s">&#39;clientConnectionString&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_conn_str</span>

        <span class="n">is_managed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">conn_type</span> <span class="o">==</span> <span class="s">&quot;serverOnly&quot;</span><span class="p">:</span>
            <span class="n">is_managed</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">item</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">][</span><span class="s">&#39;isManaged&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_managed</span>
            
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;item&quot;</span> <span class="p">:</span> <span class="n">item</span>
        <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/registerItem&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span> <span class="ow">or</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DatastoreItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;/enterpriseDatabases/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="DatastoreManager.add"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Registers a new data item with the data store.</span>
<span class="sd">        Input</span>
<span class="sd">            item - The disct representing the data item.                    </span>
<span class="sd">            See http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000001s9000000</span>
<span class="sd">        Output:</span>
<span class="sd">              True if the data item is registered successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&#39;item&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/registerItem&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span> <span class="ow">or</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DatastoreItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;/enterpriseDatabases/&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">None</span>
    </div>
<div class="viewcode-block" id="DatastoreManager.get"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the data item object at the given path</span>

<span class="sd">        Arguments</span>
<span class="sd">            path        required string, the data item path</span>
<span class="sd">        :return:</span>
<span class="sd">            None if the data item is not found at that path and the data item object if its found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">}</span>
        <span class="n">urlpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/items&quot;</span> <span class="o">+</span> <span class="n">path</span>

        <span class="n">datadict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;status&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">datadict</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DatastoreItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">datadict</span><span class="p">[</span><span class="s">&#39;messages&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="DatastoreManager.search"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.search">[docs]</a>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ancestor_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">types</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           You can use this operation to search through the various data</span>
<span class="sd">           items registered in the server&#39;s data store.</span>
<span class="sd">           Inputs:</span>
<span class="sd">              parentPath - The path of the parent under which to find items. To get the root data items, pass &#39;/&#39;</span>
<span class="sd">              ancestorPath - The path of the ancestor under which to find</span>
<span class="sd">                             items.</span>
<span class="sd">              types - A comma separated filter for the type of the items. Types include folder, egdb, bigDataFileShare, datadir</span>
<span class="sd">              id - A filter to search by the ID of the item</span>
<span class="sd">           </span>
<span class="sd">            :return:</span>
<span class="sd">            Returns a list of data items matching the specified query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">parent_path</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">ancestor_path</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">types</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ancestor_path</span> <span class="o">=</span> <span class="s">&#39;/&#39;</span>
        <span class="k">if</span> <span class="n">parent_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;parentPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_path</span>
        <span class="k">if</span> <span class="n">ancestor_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;ancestorPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ancestor_path</span>
        <span class="k">if</span> <span class="n">types</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;types&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">id</span>
        

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/findItems&quot;</span>


        <span class="n">dataitems</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;items&#39;</span><span class="p">]:</span>
            <span class="n">dataitems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DatastoreItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;path&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">dataitems</span>
</div>
<div class="viewcode-block" id="DatastoreManager.list"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           Returns a list of all registered data items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="DatastoreManager.validate"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.DatastoreManager.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Validates all items in the datastore and returns True if validated.</span>

<span class="sd">        In order for a data item to be registered and used successfully within the GIS&#39;s data store,</span>
<span class="sd">        you need to make sure that the path (for file shares) or connection string (for databases)</span>
<span class="sd">        is accessible to every server node in the site. To validate all registered data items all</span>
<span class="sd">        at once, you can invoke this operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_url</span> <span class="o">+</span> <span class="s">&quot;/data/validateAllDataItems&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span>
</div></div>
<div class="viewcode-block" id="Tools"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Tools">[docs]</a><span class="k">class</span> <span class="nc">Tools</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collection of GIS tools. This class holds references to the helper services and tools available </span>
<span class="sd">    in the GIS. This class is not created by users directly.</span>
<span class="sd">    An instance of this class, called &#39;tools&#39;, is available as a property of the GIS object.</span>
<span class="sd">    Users access the GIS tools, such as the geocoder, spatial analysis tools, geoanalytics, raster </span>
<span class="sd">    geoanalysis tools, etc through the gis.tools object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gis</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span> <span class="o">=</span> <span class="n">gis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_geocoder</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_geometry</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_analysis</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raster_analysis</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_geoanalytics</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Tools.geocoder"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Tools.geocoder">[docs]</a>    <span class="k">def</span> <span class="nf">geocoder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the geocoder, if available and configured&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geocoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geocoder</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">geocodesvcurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s">&#39;helperServices&#39;</span><span class="p">][</span><span class="s">&#39;geocode&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_geocoder</span> <span class="o">=</span> <span class="n">Geocoder</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">geocodesvcurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geocoder</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Tools.geometry"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Tools.geometry">[docs]</a>    <span class="k">def</span> <span class="nf">geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the portal&#39;s geometry  tools, if available and configured&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">svcurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s">&#39;helperServices&#39;</span><span class="p">][</span><span class="s">&#39;geometry&#39;</span><span class="p">][</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_geometry</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">svcurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Tools.rasteranalytics"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Tools.rasteranalytics">[docs]</a>    <span class="k">def</span> <span class="nf">rasteranalytics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the portal&#39;s raster analysis tools, if available and configured&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raster_analysis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raster_analysis</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">svcurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s">&#39;helperServices&#39;</span><span class="p">][</span><span class="s">&#39;rasterAnalytics&#39;</span><span class="p">][</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">svcurl</span> <span class="o">=</span> <span class="s">&#39;https://rdvmags01.esri.com/arcgis/rest/services/System/RasterAnalysisTools/GPServer&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_raster_analysis</span> <span class="o">=</span> <span class="n">RasterAnalysisTools</span><span class="p">(</span><span class="n">svcurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="p">)</span> 
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raster_analysis</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        </div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Tools.bigdata"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Tools.bigdata">[docs]</a>    <span class="k">def</span> <span class="nf">bigdata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the portal&#39;s bigdata analytics tools, if available and configured&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geoanalytics</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geoanalytics</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">svcurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s">&#39;helperServices&#39;</span><span class="p">][</span><span class="s">&#39;geoanalytics&#39;</span><span class="p">][</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;This GIS does not support geoanalytics&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">None</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_geoanalytics</span> <span class="o">=</span> <span class="n">BigDataAnalytics</span><span class="p">(</span><span class="n">svcurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="p">)</span> 
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geoanalytics</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Tools.analysis"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Tools.analysis">[docs]</a>    <span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;the portal&#39;s spatial analysis tools, if available and configured&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span> 
                <span class="n">svcurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s">&#39;helperServices&#39;</span><span class="p">][</span><span class="s">&#39;analysis&#39;</span><span class="p">][</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">svcurl</span> <span class="o">=</span> <span class="s">&#39;https://analysis6.arcgis.com/arcgis/rest/services/tasks/GPServer&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_analysis</span> <span class="o">=</span> <span class="n">SpatialAnalysisTools</span><span class="p">(</span><span class="n">svcurl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analysis</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    </div></div>
<div class="viewcode-block" id="UserManager"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager">[docs]</a><span class="k">class</span> <span class="nc">UserManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manager class for managing GIS users. This class is not created by users directly.</span>
<span class="sd">    An instance of this class, called &#39;users&#39;, is available as a property of the Gis object.</span>
<span class="sd">    Users call methods on this &#39;users&#39; object to manipulate (create, get, search...) users.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portal</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portal</span>


    
<div class="viewcode-block" id="UserManager.create"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">firstname</span><span class="p">,</span> <span class="n">lastname</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="s">&#39;org_user&#39;</span><span class="p">,</span> 
               <span class="n">provider</span><span class="o">=</span><span class="s">&#39;arcgis&#39;</span><span class="p">,</span> <span class="n">idpUsername</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This operation is used to pre-create built-in or enterprise accounts within the portal. </span>
<span class="sd">        The provider parameter is used to indicate the type of user account. Only an administrator</span>
<span class="sd">        can call this method.</span>

<span class="sd">        .. note:</span>
<span class="sd">            When Portal for ArcGIS is connected to an enterprise identity store, enterprise users sign</span>
<span class="sd">            into portal using their enterprise credentials. By default, new installations of Portal for</span>
<span class="sd">            ArcGIS do not allow accounts from an enterprise identity store to be registered to the portal</span>
<span class="sd">            automatically. Only users with accounts that have been pre-created can sign in to the portal.</span>
<span class="sd">            Alternatively, you can configure the portal to register enterprise accounts the first time</span>
<span class="sd">            the user connects to the website. </span>

<span class="sd">        ================  ===============================================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        username          required string, must be unique in the Portal,</span>
<span class="sd">                          &gt;=6 characters, =&lt;24 characters</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        password          required string, must be &gt;= 8 characters. This is a required parameter only if </span>
<span class="sd">                          the provider is arcgis; otherwise, the password parameter is ignored.</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        firstname         required string, the first name for the user</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        lastname          required string, the last name for the user</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        email             required string, must be an email address</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        description       An optional description string for the user account.</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        role              The role for the user account. The default value is org_user.</span>
<span class="sd">                          Values: org_user | org_publisher | org_admin</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        provider          The provider for the account. The default value is arcgis.</span>
<span class="sd">                          Values: arcgis | enterprise</span>
<span class="sd">        ----------------  -------------------------------------------------------------------------------</span>
<span class="sd">        idpUsername       The name of the user as stored by the enterprise user store. This parameter is </span>
<span class="sd">                          only required if the provider parameter is enterprise.</span>
<span class="sd">        ================  ===============================================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            the user, if created, else None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">createuser_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/portaladmin/security/users/createUser&quot;</span>
        <span class="c">#print(createuser_url)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
            <span class="s">&#39;username&#39;</span> <span class="p">:</span> <span class="n">username</span><span class="p">,</span>
            <span class="s">&#39;password&#39;</span> <span class="p">:</span> <span class="n">password</span><span class="p">,</span>
            <span class="s">&#39;firstname&#39;</span> <span class="p">:</span> <span class="n">firstname</span><span class="p">,</span>
            <span class="s">&#39;lastname&#39;</span> <span class="p">:</span> <span class="n">lastname</span><span class="p">,</span>
            <span class="s">&#39;email&#39;</span> <span class="p">:</span> <span class="n">email</span><span class="p">,</span>
            <span class="s">&#39;description&#39;</span> <span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s">&#39;role&#39;</span> <span class="p">:</span> <span class="n">role</span><span class="p">,</span>
            <span class="s">&#39;provider&#39;</span> <span class="p">:</span> <span class="n">provider</span><span class="p">,</span>
            <span class="s">&#39;idpUsername&#39;</span> <span class="p">:</span> <span class="n">idpUsername</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">createuser_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="UserManager.signup"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager.signup">[docs]</a>    <span class="k">def</span> <span class="nf">signup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">fullname</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Signs up users to an instance of Portal for ArcGIS.</span>

<span class="sd">        .. note:</span>
<span class="sd">            This method only applies to Portal and not ArcGIS</span>
<span class="sd">            Online.  This method can be called anonymously, but</span>
<span class="sd">            keep in mind that self-signup can also be disabled</span>
<span class="sd">            in a Portal.  It also only creates built-in</span>
<span class="sd">            accounts, it does not work with enterprise</span>
<span class="sd">            accounts coming from ActiveDirectory or your</span>
<span class="sd">            LDAP.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        username          required string, must be unique in the Portal,</span>
<span class="sd">                          &gt;4 characters</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        password          required string, must be &gt;= 8 characters.</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        fullname          required string, name of the user</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        email             required string, must be an email address</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            the user, if created, else None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">signup</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">fullname</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">User</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="UserManager.get"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the user object for the specified username.</span>

<span class="sd">        Arguments</span>
<span class="sd">            username        required string, the username whose user object you want.</span>
<span class="sd">        :return:</span>
<span class="sd">            None if the user is not found and returns a user object if the user is found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">User</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">user</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="UserManager.list"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_users</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the list of users in your organization. This method does not work with </span>
<span class="sd">        ArcGIS Online, only with Portal for ArcGIS.</span>
<span class="sd">         Arguments</span>
<span class="sd">            max_users : optional int, the maximum number of users to return.</span>

<span class="sd">        :return: The list of users in your org</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># userlist = []</span>
        <span class="n">users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_org_users</span><span class="p">(</span><span class="n">max_users</span><span class="p">)</span>
        <span class="c"># for user in users:</span>
        <span class="c">#     userlist.append(User(self._portal, user[&#39;username&#39;], user))</span>
        <span class="c"># return userlist</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">User</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">],</span> <span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">users</span><span class="p">]</span>
        <span class="c">#https://portalpy.esri.com/arcgis/sharing/rest/portals/self/users?start=2&amp;num=2&amp;sortField=fullname&amp;sortOrder=asc&amp;f=pjson</span>
</div>
<div class="viewcode-block" id="UserManager.search"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager.search">[docs]</a>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">sort_field</span><span class="o">=</span><span class="s">&#39;username&#39;</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="s">&#39;asc&#39;</span><span class="p">,</span> <span class="n">max_users</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">add_org</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Searches portal users.</span>

<span class="sd">        Returns a list of users matching the specified query</span>

<span class="sd">        .. note::</span>
<span class="sd">            A few things that will be helpful to know.</span>

<span class="sd">            1. The query syntax has quite a few features that can&#39;t</span>
<span class="sd">               be adequately described here.  The query syntax is</span>
<span class="sd">               available in ArcGIS help.  A short version of that URL</span>
<span class="sd">               is http://bitly.com/1fJ8q31.</span>

<span class="sd">            2. Most of the time when searching groups you want to</span>
<span class="sd">               search within your organization in ArcGIS Online</span>
<span class="sd">               or within your Portal.  As a convenience, the method</span>
<span class="sd">               automatically appends your organization id to the query by</span>
<span class="sd">               default.  If you don&#39;t want the API to append to your query</span>
<span class="sd">               set add_org to false.  If you use this feature with an</span>
<span class="sd">               OR clause such as field=x or field=y you should put this</span>
<span class="sd">               into parenthesis when using add_org.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        query             required string, query string.  See notes.</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        sort_field        optional string, valid values can be username or created</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        sort_order        optional string, valid values are asc or desc</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        max_users         optional int, maximum number of users returned</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        add_org           optional boolean, controls whether to search within your</span>
<span class="sd">                          org (default is True)</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            A list of users:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">userlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">search_users</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">sort_field</span><span class="p">,</span> <span class="n">sort_order</span><span class="p">,</span> <span class="n">max_users</span><span class="p">,</span> <span class="n">add_org</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
            <span class="n">userlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">user</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">],</span> <span class="n">user</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">userlist</span>

        <span class="c">#TODO: remove org users, invite users</span>
</div>
<div class="viewcode-block" id="UserManager.logged_in_user"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.UserManager.logged_in_user">[docs]</a>    <span class="k">def</span> <span class="nf">logged_in_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the logged in user</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">imemyself</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">logged_in_user</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">User</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">imemyself</span><span class="p">[</span><span class="s">&#39;username&#39;</span><span class="p">],</span> <span class="n">imemyself</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="GroupManager"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GroupManager">[docs]</a><span class="k">class</span> <span class="nc">GroupManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manager class for manipulating GIS groups. This class is not created by users directly.</span>
<span class="sd">    An instance of this class, called &#39;groups&#39;, is available as a property of the Gis object.</span>
<span class="sd">    Users call methods on this &#39;groups&#39; object to manipulate (create, get, search...) users.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portal</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portal</span>

<div class="viewcode-block" id="GroupManager.create"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GroupManager.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">snippet</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="s">&#39;public&#39;</span><span class="p">,</span> <span class="n">thumbnail</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">is_invitation_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sort_field</span><span class="o">=</span><span class="s">&#39;avgRating&#39;</span><span class="p">,</span>
               <span class="n">sort_order</span><span class="o">=</span><span class="s">&#39;desc&#39;</span><span class="p">,</span> <span class="n">is_view_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a group and returns it if successful.</span>

<span class="sd">        ================  =========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        title             required string, name of the group</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        tags              required string, comma-delimited list of tags</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        description       optional string, describes group in detail</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        snippet           optional string, &lt;250 characters summarizes group</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        access            optional string, can be private, public, or org</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        thumbnail         optional string, URL to group image</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        is_invitation_only  optional boolean, defines whether users can join by</span>
<span class="sd">                          request.</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        sort_field        optional string, specifies how shared items with</span>
<span class="sd">                          the group are sorted.</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        sort_order        optional string, asc or desc for ascending or descending.</span>
<span class="sd">        ----------------  ---------------------------------------------------------</span>
<span class="sd">        is_view_only      optional boolean, defines whether the group is searchable</span>
<span class="sd">        ================  =========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            the group, if created, or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">groupid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">create_group_from_dict</span><span class="p">({</span>
            <span class="s">&#39;title&#39;</span> <span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s">&#39;tags&#39;</span> <span class="p">:</span> <span class="n">tags</span><span class="p">,</span> <span class="s">&#39;description&#39;</span> <span class="p">:</span> <span class="n">description</span><span class="p">,</span>
            <span class="s">&#39;snippet&#39;</span> <span class="p">:</span> <span class="n">snippet</span><span class="p">,</span> <span class="s">&#39;access&#39;</span> <span class="p">:</span> <span class="n">access</span><span class="p">,</span> <span class="s">&#39;sortField&#39;</span> <span class="p">:</span> <span class="n">sort_field</span><span class="p">,</span>
            <span class="s">&#39;sortOrder&#39;</span> <span class="p">:</span> <span class="n">sort_order</span><span class="p">,</span> <span class="s">&#39;isViewOnly&#39;</span> <span class="p">:</span> <span class="n">is_view_only</span><span class="p">,</span>
            <span class="s">&#39;isinvitationOnly&#39;</span> <span class="p">:</span> <span class="n">is_invitation_only</span><span class="p">},</span> <span class="n">thumbnail</span><span class="p">)</span>
        <span class="c">#print(groupid)</span>
        <span class="k">if</span> <span class="n">groupid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">groupid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="GroupManager.create_from_dict"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GroupManager.create_from_dict">[docs]</a>    <span class="k">def</span> <span class="nf">create_from_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a group with parameters specified in the dict</span>
<span class="sd">        See help of create() method for parameters</span>
<span class="sd">        :return:</span>
<span class="sd">            the group, if created, or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;thumbnail&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        
        <span class="n">groupid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">create_group_from_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">)</span>
        <span class="c">#print(groupid)</span>
        <span class="k">if</span> <span class="n">groupid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">groupid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="GroupManager.get"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GroupManager.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the group object for the specified groupid.</span>

<span class="sd">        Arguments</span>
<span class="sd">            groupid        required string, the group identifier</span>
<span class="sd">        :return:</span>
<span class="sd">            None if the group is not found and returns a group object if the group is found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">groupid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">groupid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="GroupManager.list"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GroupManager.list">[docs]</a>    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_groups</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the list of groups in your organization</span>
<span class="sd">         Arguments</span>
<span class="sd">            max_groups : optional int, the maximum number of groups to return.</span>

<span class="sd">        :return: The list of groups in your org</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">max_groups</span><span class="o">=</span><span class="n">max_groups</span><span class="p">,</span> <span class="n">add_org</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c">#https://portalpy.esri.com/arcgis/sharing/rest/community/groups?q=orgid%3A0123456789ABCDEF&amp;sortField=&amp;sortOrder=</span>
</div>
<div class="viewcode-block" id="GroupManager.search"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.GroupManager.search">[docs]</a>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">sort_field</span><span class="o">=</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="s">&#39;asc&#39;</span><span class="p">,</span>
               <span class="n">max_groups</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">add_org</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Searches for portal groups.</span>

<span class="sd">        .. note::</span>
<span class="sd">            A few things that will be helpful to know.</span>

<span class="sd">            1. The query syntax has quite a few features that can&#39;t</span>
<span class="sd">                be adequately described here.  The query syntax is</span>
<span class="sd">                available in ArcGIS help.  A short version of that URL</span>
<span class="sd">                is http://bitly.com/1fJ8q31.</span>

<span class="sd">            2. Most of the time when searching groups you want to</span>
<span class="sd">                search within your organization in ArcGIS Online</span>
<span class="sd">                or within your Portal.  As a convenience, the method</span>
<span class="sd">                automatically appends your organization id to the query by</span>
<span class="sd">                default.  If you don&#39;t want the API to append to your query</span>
<span class="sd">                set add_org to false.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        query             optional query string on Portal, required for Online.</span>
<span class="sd">                          If not specified, all groups will be searched. See notes </span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        sort_field        optional string, valid values can be title, owner,</span>
<span class="sd">                          created</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        sort_order        optional string, valid values are asc or desc</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        max_groups        optional int, maximum number of groups returned</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        add_org           optional boolean, controls whether to search within</span>
<span class="sd">                          your org</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">        Returns a list of groups matching the specified query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grouplist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">search_groups</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">sort_field</span><span class="p">,</span> <span class="n">sort_order</span><span class="p">,</span> <span class="n">max_groups</span><span class="p">,</span> <span class="n">add_org</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">grouplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">grouplist</span>
</div></div>
<span class="k">def</span> <span class="nf">_is_shapefile</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">is_zipfile</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">zf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">namelist</span> <span class="o">=</span> <span class="n">zf</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">namelist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.shp&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.SHP&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>


<div class="viewcode-block" id="ContentManager"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager">[docs]</a><span class="k">class</span> <span class="nc">ContentManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manager class for manipulating GIS content. This class is not created by users directly.</span>
<span class="sd">    An instance of this class, called &#39;content&#39;, is available as a property of the Gis object.</span>
<span class="sd">    Users call methods on this &#39;content&#39; object to manipulate (create, get, search...) items.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portal</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portal</span>

<div class="viewcode-block" id="ContentManager.add"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_properties</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">thumbnail</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds content to a Portal by creating an item.</span>


<span class="sd">            .. note::</span>
<span class="sd">                That content can be a file (such as a service definition, shapefile, CSV, layer package, geoprocessing package,</span>
<span class="sd">                map package) or it can be a URL (to an ArcGIS Server service, WMS service,</span>
<span class="sd">                or an application).</span>

<span class="sd">                If you are uploading a package or other file, provide a path or URL</span>
<span class="sd">                to the file in the data argument.</span>

<span class="sd">                From a technical perspective, none of the item properties below are required.  However,</span>
<span class="sd">                it is strongly recommended that title, type, typeKeywords, tags, snippet, and description</span>
<span class="sd">                be provided.</span>


<span class="sd">            ===============     ====================================================</span>
<span class="sd">            **Argument**        **Description**</span>
<span class="sd">            ---------------     ----------------------------------------------------</span>
<span class="sd">            item_properties     required dictionary, see below for the keys and</span>
<span class="sd">                                values</span>
<span class="sd">            ---------------     ----------------------------------------------------</span>
<span class="sd">            data                optional string, either a path or URL to the data</span>
<span class="sd">            ---------------     ----------------------------------------------------</span>
<span class="sd">            thumbnail           optional string, either a path or URL to an image</span>
<span class="sd">            ---------------     ----------------------------------------------------</span>
<span class="sd">            metadata            optional string, either a path or URL to metadata.</span>
<span class="sd">            ---------------     ----------------------------------------------------</span>
<span class="sd">            owner               optional string, defaults to logged in user.</span>
<span class="sd">            ---------------     ----------------------------------------------------</span>
<span class="sd">            folder              optional string, content folder where placing item</span>
<span class="sd">            ===============     ====================================================</span>


<span class="sd">            =================  ============================================================================</span>
<span class="sd">             **Key**            **Value**</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            type               optional string, indicates type of item.  See URL 1 below for valid values.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            typeKeywords       optinal string list.  Lists all sub-types.  See URL 1 for valid values.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            description        optional string.  Description of the item.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            title              optional string.  Name of the item.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            url                optional string.  URL to item that are based on URLs.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            tags               optional string of comma-separated values.  Used for searches on items.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            snippet            optional string.  Provides a very short summary of the what the item is.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            extent             optional string with comma separated values for min x, min y, max x, max y.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            spatialReference   optional string.  Coordinate system that the item is in.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            accessInformation  optional string.  Information on the source of the content.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            licenseInfo        optinal string, any license information or restrictions regarding content.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            culture            optional string.  Locale, country and language information.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            access             optional string.  Valid values: private, shared, org, or public.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            commentsEnabled    optional boolean.  Default is true.  Controls whether comments are allowed.</span>
<span class="sd">            -----------------  ----------------------------------------------------------------------------</span>
<span class="sd">            culture            optional string.  Language and country information.</span>
<span class="sd">            =================  ============================================================================</span>


<span class="sd">	    URL 1: http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000ms000000</span>

<span class="sd">            :return:</span>
<span class="sd">                 The item if successfully added, None if unsuccessful.</span>
<span class="sd">            &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>    
            <span class="n">title</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">data</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">extn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">data</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">extn</span> <span class="o">==</span> <span class="s">&#39;.CSV&#39;</span><span class="p">):</span>
                <span class="n">filetype</span> <span class="o">=</span> <span class="s">&#39;CSV&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">extn</span> <span class="o">==</span> <span class="s">&#39;.SD&#39;</span><span class="p">):</span>
                <span class="n">filetype</span> <span class="o">=</span> <span class="s">&#39;Service Definition&#39;</span>
            <span class="k">if</span> <span class="n">_is_shapefile</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">filetype</span> <span class="o">=</span> <span class="s">&#39;Shapefile&#39;</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="s">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">item_properties</span><span class="p">:</span>
                <span class="n">item_properties</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filetype</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s">&#39;title&#39;</span> <span class="ow">in</span> <span class="n">item_properties</span><span class="p">:</span>
                <span class="n">item_properties</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>

        <span class="n">owner_name</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">User</span><span class="p">):</span>
            <span class="n">owner_name</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">username</span>

        <span class="n">itemid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">item_properties</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">owner_name</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">itemid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="ContentManager.create_service"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.create_service">[docs]</a>    <span class="k">def</span> <span class="nf">create_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> 
                       <span class="n">service_description</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> 
                       <span class="n">has_static_data</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> 
                       <span class="n">max_record_count</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                       <span class="n">supported_query_formats</span> <span class="o">=</span> <span class="s">&quot;JSON&quot;</span><span class="p">,</span>
                       <span class="n">capabilities</span> <span class="o">=</span> <span class="s">&quot;Image,Catalog,Metadata,Download,Pixels,Edit,Mensuration,Uploads&quot;</span><span class="p">,</span>
                       <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                       <span class="n">copyright_text</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                       <span class="n">wkid</span><span class="o">=</span><span class="mi">102100</span><span class="p">,</span>
                       <span class="n">service_type</span><span class="o">=</span><span class="s">&quot;imageService&quot;</span><span class="p">,</span>
                       <span class="n">owner</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a service in the Portal</span>


<span class="sd">            :return:</span>
<span class="sd">                 The item for the service, if successfully added, None if unsuccessful.</span>
<span class="sd">            &quot;&quot;&quot;</span>

        <span class="n">itemid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> 
                       <span class="n">service_description</span><span class="p">,</span> 
                       <span class="n">has_static_data</span><span class="p">,</span> 
                       <span class="n">max_record_count</span><span class="p">,</span>
                       <span class="n">supported_query_formats</span><span class="p">,</span>
                       <span class="n">capabilities</span><span class="p">,</span>
                       <span class="n">description</span><span class="p">,</span>
                       <span class="n">copyright_text</span><span class="p">,</span>
                       <span class="n">wkid</span><span class="p">,</span>
                       <span class="n">service_type</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">itemid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="ContentManager.get"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the item object for the specified itemid.</span>

<span class="sd">        Arguments</span>
<span class="sd">            itemid        required string, the item identifier</span>
<span class="sd">        :return:</span>
<span class="sd">            None if the item is not found and returns an item object if the item is found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="n">itemid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="ContentManager.search"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.search">[docs]</a>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">item_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sort_field</span><span class="o">=</span><span class="s">&#39;numViews&#39;</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="s">&#39;desc&#39;</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">add_org</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Searches for portal items.</span>

<span class="sd">        .. note::</span>
<span class="sd">            A few things that will be helpful to know.</span>

<span class="sd">            1. The query syntax has quite a few features that can&#39;t</span>
<span class="sd">                be adequately described here.  The query syntax is</span>
<span class="sd">                available in ArcGIS help.  A short version of that URL</span>
<span class="sd">                is http://bitly.com/1fJ8q31.</span>

<span class="sd">            2. Most of the time when searching groups you want to</span>
<span class="sd">                search within your organization in ArcGIS Online</span>
<span class="sd">                or within your Portal.  As a convenience, the method</span>
<span class="sd">                automatically appends your organization id to the query by</span>
<span class="sd">                default.  If you only want content from your org</span>
<span class="sd">                set add_org to True.</span>

<span class="sd">        ================  ===================================================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  -----------------------------------------------------------------------------------</span>
<span class="sd">        query             required string, query string.  See notes.</span>
<span class="sd">        ----------------  -----------------------------------------------------------------------------------</span>
<span class="sd">        item_type         optional string, set type of item to search</span>
<span class="sd">                          http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000ms000000</span>
<span class="sd">        ----------------  -----------------------------------------------------------------------------------</span>
<span class="sd">        sort_field        optional string, valid values can be title, uploaded, type, owner, modified, </span>
<span class="sd">                          avgRating, numRatings, numComments, and numViews.</span>
<span class="sd">        ----------------  -----------------------------------------------------------------------------------</span>
<span class="sd">        sort_order        optional string, valid values are asc or desc</span>
<span class="sd">        ----------------  -----------------------------------------------------------------------------------</span>
<span class="sd">        max_items         optional int, maximum number of items returned, default is 10</span>
<span class="sd">        ----------------  -----------------------------------------------------------------------------------</span>
<span class="sd">        add_org           optional boolean, controls whether to search within your org (default is False)</span>
<span class="sd">        ================  ===================================================================================</span>

<span class="sd">        :return:</span>
<span class="sd">        Returns a list of items matching the specified query</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">itemlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">query</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="n">item_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; AND &#39;</span>
        
        <span class="k">if</span> <span class="n">item_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">item_type</span> <span class="o">=</span> <span class="n">item_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;web map&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;web map&quot; NOT type:&quot;web mapping application&quot;)&#39;</span>
            <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;web scene&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;web scene&quot; NOT type:&quot;CityEngine Web Scene&quot;)&#39;</span>
            <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;feature layer&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;feature service&quot;)&#39;</span>
            <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;image layer&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;image service&quot;)&#39;</span>
            <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;layer&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;layer&quot; NOT type:&quot;layer package&quot; NOT type:&quot;Explorer Layer&quot;)&#39;</span>
            <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;feature collection&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;feature collection&quot; NOT type:&quot;feature collection template&quot;)&#39;</span>
            <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s">&quot;desktop application&quot;</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;desktop application&quot; NOT type:&quot;desktop application template&quot;)&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="s">&#39; (type:&quot;&#39;</span> <span class="o">+</span> <span class="n">item_type</span> <span class="o">+</span><span class="s">&#39;&quot;)&#39;</span>
 
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">sort_field</span><span class="o">=</span><span class="n">sort_field</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="n">sort_order</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="n">max_items</span><span class="p">,</span> <span class="n">add_org</span><span class="o">=</span><span class="n">add_org</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">itemlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">itemlist</span>
    <span class="c"># q: (type:&quot;web map&quot; NOT type:&quot;web mapping applications&quot;) AND accountid:0123456789ABCDEF</span>
</div>
<div class="viewcode-block" id="ContentManager.create_folder"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.create_folder">[docs]</a>    <span class="k">def</span> <span class="nf">create_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a folder for the given user with the given title. Does nothing if the</span>
<span class="sd">        folder already exists.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        owner             required string, the name of the user</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        folder            required string, the name of the folder to create for the owner</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a json object like the following:</span>
<span class="sd">            {&quot;username&quot; : &quot;portaladmin&quot;,&quot;id&quot; : &quot;bff13218991c4485a62c81db3512396f&quot;,&quot;title&quot; : &quot;testcreate&quot;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">folder</span> <span class="o">!=</span> <span class="s">&#39;/&#39;</span><span class="p">:</span> <span class="c"># we don&#39;t create root folder</span>
            <span class="n">owner_name</span> <span class="o">=</span> <span class="n">owner</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">User</span><span class="p">):</span>
                <span class="n">owner_name</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">username</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_folder_id</span><span class="p">(</span><span class="n">owner_name</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">create_folder</span><span class="p">(</span><span class="n">owner_name</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ContentManager.delete_folder"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.delete_folder">[docs]</a>    <span class="k">def</span> <span class="nf">delete_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Deletes a folder for the given user with the given folder name.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        owner             required string, the name of the user</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        folder            required string, the name of the folder</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean if succeeded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">folder</span> <span class="o">!=</span> <span class="s">&#39;/&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">delete_folder</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>

    <span class="c">#def get_folder_id(self, owner, folder_name):</span>
    <span class="c">#    &quot;&quot;&quot; Finds the folder for a particular owner and returns its id.</span>

    <span class="c">#    ================  ========================================================</span>
    <span class="c">#    **Argument**      **Description**</span>
    <span class="c">#    ----------------  --------------------------------------------------------</span>
    <span class="c">#    owner             required string, the name of the user</span>
    <span class="c">#    ----------------  --------------------------------------------------------</span>
    <span class="c">#    folder_name       required string, the name of the folder to search for</span>
    <span class="c">#    ================  ========================================================</span>

    <span class="c">#    :return:</span>
    <span class="c">#        a boolean if succeeded.</span>
    <span class="c">#    &quot;&quot;&quot;</span>
    <span class="c">#    return self._portal.get_folder_id(owner, folder_name)</span>
</div>
<div class="viewcode-block" id="ContentManager.import_data"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.ContentManager.import_data">[docs]</a>    <span class="k">def</span> <span class="nf">import_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">address_fields</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Imports a Pandas data frame, that has an address column,</span>
<span class="sd">        to a feature collection</span>


<span class="sd">        df : pandas dataframe</span>
<span class="sd">        address_fields : dict containing mapping of df columns to address fields, eg: { &quot;CountryCode&quot; : &quot;Country&quot;} or { &quot;Address&quot; : &quot;Address&quot; } </span>

<span class="sd">        Returns feature collection, that can be used for analysis, visualization or published to the GIS as an item</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;content/features/analyze&quot;</span>

        <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span><span class="p">:</span> <span class="s">&quot;pjson&quot;</span><span class="p">,</span>
            <span class="s">&quot;text&quot;</span> <span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(),</span>
            <span class="s">&quot;filetype&quot;</span> <span class="p">:</span> <span class="s">&quot;csv&quot;</span><span class="p">,</span>

            <span class="s">&quot;analyzeParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="s">&quot;enableGlobalGeocoding&quot;</span><span class="p">:</span> <span class="s">&quot;true&quot;</span><span class="p">,</span>
                <span class="s">&quot;sourceLocale&quot;</span><span class="p">:</span><span class="s">&quot;en-us&quot;</span><span class="p">,</span>
                <span class="c">#&quot;locationType&quot;:&quot;address&quot;,</span>
                <span class="s">&quot;sourceCountry&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot;sourceCountryHint&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">address_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;analyzeParameters&#39;</span><span class="p">][</span><span class="s">&#39;locationType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;address&#39;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span>
        <span class="c">#import json</span>
        <span class="c">#json.dumps(res)</span>
        <span class="k">if</span> <span class="n">address_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="s">&#39;publishParameters&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;addressFields&quot;</span><span class="p">:</span><span class="n">address_fields</span><span class="p">})</span>

        <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;content/features/generate&quot;</span>
        <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span><span class="p">:</span> <span class="s">&quot;pjson&quot;</span><span class="p">,</span>
            <span class="s">&quot;text&quot;</span> <span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(),</span>
            <span class="s">&quot;filetype&quot;</span> <span class="p">:</span> <span class="s">&quot;csv&quot;</span><span class="p">,</span>
            <span class="s">&quot;publishParameters&quot;</span> <span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;publishParameters&#39;</span><span class="p">])</span>
        <span class="p">}</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">postdata</span><span class="p">,</span> <span class="n">use_ordered_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c">#print(json.dumps(res))</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s">&#39;featureCollection&#39;</span><span class="p">][</span><span class="s">&#39;layers&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">fc</span>


</div></div>
<div class="viewcode-block" id="Group"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group">[docs]</a><span class="k">class</span> <span class="nc">Group</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a group (for example, San Bernardino Fires) within the GIS (ArcGIS Online or Portal for ArcGIS)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portal</span><span class="p">,</span> <span class="n">groupid</span><span class="p">,</span> <span class="n">groupdict</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span> <span class="o">=</span> <span class="n">groupid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">groupdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">groupdict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="c"># support group attributes as group.access, group.owner, group.phone etc</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        groupdict = self._portal.get_group(self.groupid)</span>
<span class="sd">        super().update(groupdict)</span>
<span class="sd">        self.__dict__.update(groupdict)</span>
<span class="sd">        return groupdict[name]</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="c"># support group attributes as dictionary keys on this object, eg. group[&#39;owner&#39;]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">groupdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;   </span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s"> title:&quot;</span><span class="si">%s</span><span class="s">&quot; owner:</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>

<div class="viewcode-block" id="Group.get_thumbnail_link"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.get_thumbnail_link">[docs]</a>    <span class="k">def</span> <span class="nf">get_thumbnail_link</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; URL to the thumbnail image &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;http://www.arcgis.com/home/images/group-no-image.png&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">+</span> <span class="s">&#39;community/groups/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">return</span> <span class="n">thumbnail_url_path</span>
</div>
    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">is_logged_in</span><span class="p">():</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thumbnail_link</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_thumbnail</span><span class="p">())</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="s">&quot;data:image/png;base64,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b64</span><span class="p">,</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&#39; &quot;</span>
        
        <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="n">snippet</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="n">owner</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">snippet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">snippet</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">snippet</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">owner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">owner</span> <span class="o">=</span> <span class="s">&#39;Not available&#39;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">url</span>  <span class="o">+</span> <span class="s">&quot;/home/group.html?id=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span>
        <span class="k">return</span> <span class="s">&quot;&quot;&quot;&lt;div class=&quot;9item_container&quot; style=&quot;height: auto; overflow: hidden; border: 1px solid #cfcfcf; border-radius: 2px; background: #f6fafa; line-height: 1.21429em; padding: 10px;&quot;&gt;</span>
<span class="s">                    &lt;div class=&quot;item_left&quot; style=&quot;width: 210px; float: left;&quot;&gt;</span>
<span class="s">                       &lt;a href=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; target=&#39;_blank&#39;&gt;</span>
<span class="s">                        &lt;img src=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; class=&quot;itemThumbnail&quot;&gt;</span>
<span class="s">                       &lt;/a&gt;</span>
<span class="s">                    &lt;/div&gt;</span>
<span class="s">        </span>
<span class="s">                    &lt;div class=&quot;item_right&quot; style=&quot;float: none; width: auto; overflow: hidden;&quot;&gt;</span>
<span class="s">                        &lt;a href=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; target=&#39;_blank&#39;&gt;&lt;b&gt;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&lt;/b&gt;</span>
<span class="s">                        &lt;/a&gt;</span>
<span class="s">                        &lt;br&gt;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Summary&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">snippet</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Description&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>  <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Owner&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">owner</span><span class="p">)</span>  <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Created&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">created</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%B </span><span class="si">%d</span><span class="s">, %Y&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        </span>
<span class="s">                    &lt;/div&gt;</span>
<span class="s">                &lt;/div&gt;</span>
<span class="s">                &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Group.content"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.content">[docs]</a>    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of items shared with this group.&quot;&quot;&quot;</span>
        <span class="n">itemlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&#39;group:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="n">max_items</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">itemlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">itemlist</span>
        </div>
<div class="viewcode-block" id="Group.delete"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Deletes this group.</span>

<span class="sd">        Returns</span>
<span class="sd">            a boolean indicating whether it was successful.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">delete_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.get_thumbnail"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.get_thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">get_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the bytes that make up the thumbnail for this group.</span>

<span class="sd">        Arguments</span>
<span class="sd">            None</span>

<span class="sd">        Returns</span>
<span class="sd">            bytes that represent the image.</span>

<span class="sd">        Example</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            response = group.get_thumbnail()</span>
<span class="sd">            f = open(filename, &#39;wb&#39;)</span>
<span class="sd">            f.write(response)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_group_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.download_thumbnail"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.download_thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">download_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Downloads the group thumbnail for this group, returns file path. &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>

        <span class="c"># Only proceed if a thumbnail exists</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="s">&#39;community/groups/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">if</span> <span class="n">thumbnail_url_path</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
                    <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">thumbnail_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span> <span class="c">#If &gt; 50 chars, truncate to last 30 chars</span>
                    <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:]</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">thumbnail_url_path</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">file_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Group.add_users"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.add_users">[docs]</a>    <span class="k">def</span> <span class="nf">add_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usernames</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds users to this group.</span>
<span class="sd">        .. note::</span>
<span class="sd">            This method will only work if the user for the</span>
<span class="sd">            Portal object is either an administrator for the entire</span>
<span class="sd">            Portal or the owner of the group.</span>

<span class="sd">        ============  ======================================</span>
<span class="sd">        **Argument**  **Description**</span>
<span class="sd">        ------------  --------------------------------------</span>
<span class="sd">        usernames     list of usernames</span>
<span class="sd">        ============  ======================================</span>

<span class="sd">        :return:</span>
<span class="sd">             A dictionary with a key of &quot;not_added&quot; which contains the users that were not</span>
<span class="sd">             added to the group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">add_group_users</span><span class="p">(</span><span class="n">usernames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.remove_users"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.remove_users">[docs]</a>    <span class="k">def</span> <span class="nf">remove_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usernames</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Remove users from this group.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        usernames         required string, comma-separated list of users</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a dictionary with a key notRemoved that is a list of users not removed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">remove_group_users</span><span class="p">(</span><span class="n">usernames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.invite_users"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.invite_users">[docs]</a>    <span class="k">def</span> <span class="nf">invite_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usernames</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="s">&#39;group_member&#39;</span><span class="p">,</span> <span class="n">expiration</span><span class="o">=</span><span class="mi">10080</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Invites users to this group.</span>

<span class="sd">        .. note::</span>
<span class="sd">            A user who is invited to this group will see a list of invitations</span>
<span class="sd">            in the &quot;Groups&quot; tab of portal listing invitations.  The user</span>
<span class="sd">            can either accept or reject the invitation.</span>

<span class="sd">        Requires</span>
<span class="sd">            The user executing the command must be group owner</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        usernames:        a required string list of users to invite</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        role:             an optional string, either group_member or group_admin</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        expiration:       an optional int, specifies how long the invitation is</span>
<span class="sd">                          valid for in minutes.</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean that indicates whether the call succeeded.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">invite_group_users</span><span class="p">(</span><span class="n">usernames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">expiration</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.reassign_to"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.reassign_to">[docs]</a>    <span class="k">def</span> <span class="nf">reassign_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_owner</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reassigns this group to another owner.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        target_owner      required string, username of new group owner</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean, indicating success</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">reassign_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">,</span> <span class="n">target_owner</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.get_members"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.get_members">[docs]</a>    <span class="k">def</span> <span class="nf">get_members</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns members of this group.</span>

<span class="sd">        Arguments</span>
<span class="sd">            None.</span>

<span class="sd">        Returns</span>
<span class="sd">            a dictionary with keys: owner, admins, and users.</span>

<span class="sd">            ================  ========================================================</span>
<span class="sd">            **Key**           **Value**</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            owner             string value, the group&#39;s owner</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            admins            list of strings, typically this is the same as the owner</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            users             list of strings, the members of the group</span>
<span class="sd">            ================  ========================================================</span>

<span class="sd">        Example (to print users in a group)</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            response = group.get_members()</span>
<span class="sd">            for user in response[&#39;users&#39;] :</span>
<span class="sd">                print user</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_group_members</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.update"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">snippet</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">is_invitation_only</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sort_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_view_only</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">thumbnail</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates this group.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Only provide the values for the arguments you wish to update.</span>

<span class="sd">        ==================  =========================================================</span>
<span class="sd">        **Argument**        **Description**</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        title               optional string, name of the group</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        tags                optional string, comma-delimited list of tags</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        description         optional string, describes group in detail</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        snippet             optional string, &lt;250 characters summarizes group</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        access              optional string, can be private, public, or org</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        thumbnail           optional string, URL or file location to group image</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        is_invitation_only  optional boolean, defines whether users can join by</span>
<span class="sd">                            request.</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        sort_field          optional string, specifies how shared items with the</span>
<span class="sd">                            group are sorted.</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        sort_order          optional string, asc or desc for ascending or descending.</span>
<span class="sd">        ------------------  ---------------------------------------------------------</span>
<span class="sd">        is_view_only        optional boolean, defines whether the group is searchable</span>
<span class="sd">        ==================  =========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean indicating success</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">update_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">snippet</span><span class="p">,</span> <span class="n">access</span><span class="p">,</span> <span class="n">is_invitation_only</span><span class="p">,</span> <span class="n">sort_field</span><span class="p">,</span> <span class="n">sort_order</span><span class="p">,</span> <span class="n">is_view_only</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Group.leave"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Group.leave">[docs]</a>    <span class="k">def</span> <span class="nf">leave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Removes the logged in user from the specified group.</span>

<span class="sd">        Requires:</span>
<span class="sd">            User must be logged in.</span>

<span class="sd">        Arguments:</span>
<span class="sd">             None.</span>

<span class="sd">        :return:</span>
<span class="sd">             a boolean indicating whether the operation was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">leave_group</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="User"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User">[docs]</a><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a registered user of the GIS (ArcGIS Online, or Portal for ArcGIS).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portal</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">userdict</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">userdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">userdict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">userdict</span><span class="p">)</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">userdict</span><span class="p">)</span>

    <span class="c"># Using http://code.activestate.com/recipes/52308-the-simple-but-handy-collector-of-a-bunch-of-named/?in=user-97991</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="c"># support user attributes as user.access, user.email, user.role etc</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        userdict = self._portal.get_user(self.username)</span>
<span class="sd">        super().update(userdict)</span>
<span class="sd">        self.__dict__.update(userdict)</span>
<span class="sd">        return userdict[name]</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="c"># support user attributes as dictionary keys on this object, eg. user[&#39;role&#39;]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">userdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">userdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">userdict</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="c">#userdict[k]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;   </span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s"> username:</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

<div class="viewcode-block" id="User.get_thumbnail_link"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.get_thumbnail_link">[docs]</a>    <span class="k">def</span> <span class="nf">get_thumbnail_link</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; URL to the thumbnail image &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;http://www.arcgis.com/home/js/arcgisonline/css/images/no-user-thumb.jpg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">+</span> <span class="s">&#39;community/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">return</span> <span class="n">thumbnail_url_path</span>
</div>
    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">is_logged_in</span><span class="p">():</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thumbnail_link</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_thumbnail</span><span class="p">())</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="s">&quot;data:image/png;base64,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b64</span><span class="p">,</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&#39; width=&#39;200&#39; height=&#39;133&quot;</span>
        
        <span class="n">firstName</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="n">lastName</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="n">fullName</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;This user has not provided any personal information.&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">firstName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstName</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">firstName</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">lastName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastName</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">firstName</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">fullName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullName</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">fullName</span> <span class="o">=</span> <span class="s">&#39;Not Provided&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;This user has not provided any personal information.&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">url</span>  <span class="o">+</span> <span class="s">&quot;/home/user.html?user=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span>

        <span class="k">return</span> <span class="s">&quot;&quot;&quot;&lt;div class=&quot;9item_container&quot; style=&quot;height: auto; overflow: hidden; border: 1px solid #cfcfcf; border-radius: 2px; background: #f6fafa; line-height: 1.21429em; padding: 10px;&quot;&gt;</span>
<span class="s">                    &lt;div class=&quot;item_left&quot; style=&quot;width: 210px; float: left;&quot;&gt;</span>
<span class="s">                       &lt;a href=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; target=&#39;_blank&#39;&gt;</span>
<span class="s">                        &lt;img src=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; class=&quot;itemThumbnail&quot;&gt;</span>
<span class="s">                       &lt;/a&gt;</span>
<span class="s">                    &lt;/div&gt;</span>
<span class="s">        </span>
<span class="s">                    &lt;div class=&quot;item_right&quot; style=&quot;float: none; width: auto; overflow: hidden;&quot;&gt;</span>
<span class="s">                        &lt;a href=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; target=&#39;_blank&#39;&gt;&lt;b&gt;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fullName</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&lt;/b&gt;</span>
<span class="s">                        &lt;/a&gt;</span>
<span class="s">                        &lt;br&gt;&lt;br&gt;&lt;b&gt;Bio&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;First Name&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">firstName</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Last Name&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lastName</span><span class="p">)</span>  <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Username&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>  <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&lt;b&gt;Joined&lt;/b&gt;: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">created</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%B </span><span class="si">%d</span><span class="s">, %Y&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        </span>
<span class="s">                    &lt;/div&gt;</span>
<span class="s">                &lt;/div&gt;</span>
<span class="s">                &quot;&quot;&quot;</span>
                
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    def get_attributes(self):</span>
<span class="sd">       Returns information for this user.</span>

<span class="sd">        Arguments</span>
<span class="sd">            None.</span>
<span class="sd">            ---------------- --------------------------------------------------------</span>
<span class="sd">            created           time (int), when user created</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            culture           string, two-letter language code</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            description       string, user supplied description</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            fullName          string, name of the user</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            modified          time (int), when user last modified</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            region            string, may be None</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            tags              string list, of user tags</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            thumbnail         string, name of file</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            username          string, name of the user</span>

<span class="sd">       :return:</span>
<span class="sd">            A dictionary object with the following keys:</span>

<span class="sd">            ================  ========================================================</span>
<span class="sd">            **Key**           **Value**</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            access            string</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            created           time (int)</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            culture           string, two-letter language code (&#39;en&#39;)</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            description       string</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            email             string</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            fullName          string</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            idpUsername       string, name of the user in the enterprise system</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            groups            list of dictionaries.  For dictionary keys,</span>
<span class="sd">                              see get_group doc.</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            modified          time (int)</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            orgId             string, the organization id</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            preferredView     string, value is either Web, GIS, or null</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            region            string, None or two letter country code</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            role              string, value is either org_user, org_publisher,</span>
<span class="sd">                              org_admin</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            storageUsage      int</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            storageQuota      int</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            tags              list of strings</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            thumbnail         string, name of file</span>
<span class="sd">            ----------------  --------------------------------------------------------</span>
<span class="sd">            username          string, name of user</span>
<span class="sd">            ================  ========================================================</span>

<span class="sd">        return self._portal.get_user(self.username)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="User.reset"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">new_password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_security_question</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_security_answer</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Resets a user&#39;s password, security question, and/or security answer.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This function does not apply to those using enterprise accounts</span>
<span class="sd">            that come from an enterprise such as ActiveDirectory, LDAP, or SAML.</span>
<span class="sd">            It only has an effect on built-in users.</span>

<span class="sd">            If a new security question is specified, a new security answer should</span>
<span class="sd">            be provided.</span>

<span class="sd">        =====================  =========================================================</span>
<span class="sd">        **Argument**           **Description**</span>
<span class="sd">        ---------------------  ---------------------------------------------------------</span>
<span class="sd">        password               required string, current password</span>
<span class="sd">        ---------------------  ---------------------------------------------------------</span>
<span class="sd">        new_password           optional string, new password if resetting password</span>
<span class="sd">        ---------------------  ---------------------------------------------------------</span>
<span class="sd">        new_security_question  optional int, new security question if desired</span>
<span class="sd">        ---------------------  ---------------------------------------------------------</span>
<span class="sd">        new_security_answer    optional string, new security question answer if desired</span>
<span class="sd">        =====================  =========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean, indicating success</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">reset_user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">new_password</span><span class="p">,</span>
                                       <span class="n">new_security_question</span><span class="p">,</span> <span class="n">new_security_answer</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="User.update"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">preferred_view</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">thumbnail</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fullname</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">culture</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates this user&#39;s properties.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Only pass in arguments for properties you want to update.</span>
<span class="sd">            All other properties will be left as they are.  If you</span>
<span class="sd">            want to update description, then only provide</span>
<span class="sd">            the description argument.</span>

<span class="sd">        ================  ==========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        access            optional string, values: private, org, public</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        preferred_view    optional string, values: Web, GIS, null</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        description       optional string, a description of the user.</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        tags              optional string, comma-separated tags for searching</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        thumbnail         optional string, path or url to a file.  can be PNG, GIF,</span>
<span class="sd">                          JPEG, max size 1 MB</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        fullname          optional string, name of the user, only for built-in users</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        email             optional string, email address, only for built-in users</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        culture           optional string, two-letter language code, fr for example</span>
<span class="sd">        ----------------  ----------------------------------------------------------</span>
<span class="sd">        region            optional string, two-letter country code, FR for example</span>
<span class="sd">        ================  ==========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean indicating success</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">update_user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">access</span><span class="p">,</span> <span class="n">preferred_view</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">,</span> <span class="n">fullname</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">culture</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="User.update_role"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.update_role">[docs]</a>    <span class="k">def</span> <span class="nf">update_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates this user&#39;s role to org_user, org_publisher, org_admin</span>

<span class="sd">        .. note::</span>
<span class="sd">            There are three types of roles in Portal - user, publisher, and administrator.</span>
<span class="sd">            A user can share items, create maps, create groups, etc.  A publisher can</span>
<span class="sd">            do everything a user can do and create hosted services.  An administrator can</span>
<span class="sd">            do everything that is possible in Portal.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        role              required string, one of these values org_user,</span>
<span class="sd">                          org_publisher, org_admin</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean, that indicates success</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">passed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">update_user_role</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">role</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">passed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">role</span> <span class="o">=</span> <span class="n">role</span>
        <span class="k">return</span> <span class="n">passed</span>
</div>
<div class="viewcode-block" id="User.delete"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reassign_to</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Deletes this user from the portal, optionally deleting or reassigning groups and items.</span>

<span class="sd">        .. note::</span>
<span class="sd">            You can not delete a user in Portal if that user owns groups or items.  If you</span>
<span class="sd">            specify someone in the reassign_to argument then items and groups will be</span>
<span class="sd">            transferred to that user.  If that argument is not set then the method</span>
<span class="sd">            will fail if the user has items or groups that need to be reassigned.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        reassign_to       optional string, new owner of items and groups</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean indicating whether the operation succeeded or failed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">delete_user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">reassign_to</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="User.reassign_to"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.reassign_to">[docs]</a>    <span class="k">def</span> <span class="nf">reassign_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_username</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reassigns all of this user&#39;s items and groups to another user.</span>

<span class="sd">        Items are transferred to the target user into a folder named</span>
<span class="sd">        &lt;user&gt;_&lt;folder&gt; where user corresponds to the user whose items were</span>
<span class="sd">        moved and folder corresponds to the folder that was moved.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method must be executed as an administrator.  This method also</span>
<span class="sd">            can not be undone.  The changes are immediately made and permanent.</span>

<span class="sd">        ================  ===========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  -----------------------------------------------------------</span>
<span class="sd">        target_username   required string, user who will own items/groups after this.</span>
<span class="sd">        ================  ===========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean indicating success</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">reassign_user</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">target_username</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="User.get_thumbnail"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.get_thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">get_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the bytes that make up the thumbnail for this user.</span>
<span class="sd">        </span>
<span class="sd">        Arguments</span>
<span class="sd">            None.</span>
<span class="sd">            </span>
<span class="sd">        Returns </span>
<span class="sd">            bytes that represent the image.</span>
<span class="sd">            </span>
<span class="sd">        Example</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">        </span>
<span class="sd">            response = user.get_thumbnail()</span>
<span class="sd">            f = open(filename, &#39;wb&#39;)</span>
<span class="sd">            f.write(response)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="s">&#39;community/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">if</span> <span class="n">thumbnail_url_path</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">thumbnail_url_path</span><span class="p">,</span> <span class="n">try_json</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="User.download_thumbnail"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.download_thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">download_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Downloads the item thumbnail for this user, returns file path. &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        
        <span class="c"># Only proceed if a thumbnail exists</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="s">&#39;community/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">if</span> <span class="n">thumbnail_url_path</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
                    <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">thumbnail_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span> <span class="c">#If &gt; 50 chars, truncate to last 30 chars</span>
                    <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:]</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">thumbnail_url_path</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">file_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="User.content"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.User.content">[docs]</a>    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dict of user items. The keys of the dict being the users folders, &#39;/&#39; being the root folder,</span>
<span class="sd">        and the values being a list of items in that folder.&quot;&quot;&quot;</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span><span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">&#39;content/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span>
        <span class="n">root_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;items&#39;</span><span class="p">]:</span>
            <span class="n">root_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">))</span>
        
        <span class="n">retval</span><span class="p">[</span><span class="s">&#39;/&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root_items</span>

        <span class="n">folders</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;folders&#39;</span><span class="p">]:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">&#39;content/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span>  <span class="o">+</span> <span class="n">folder</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">postdata</span><span class="p">)</span>
            <span class="n">folder_items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;items&#39;</span><span class="p">]:</span>
                <span class="n">folder_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">))</span>
        
            <span class="n">retval</span><span class="p">[</span><span class="n">folder</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">folder_items</span>

        <span class="k">return</span> <span class="n">retval</span>
    
            </div></div>
<div class="viewcode-block" id="Item"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item">[docs]</a><span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An item (a unit of content) in the GIS. Each item has a unique identifier and a well</span>
<span class="sd">    known URL that is independent of the user owning the item.</span>
<span class="sd">    An item can have associated binary or textual data that&#39;s available via the item data resource.</span>
<span class="sd">    For example, an item of type Map Package returns the actual bits corresponding to the </span>
<span class="sd">    map package via the item data resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">,</span> <span class="n">itemdict</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">portal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span> <span class="o">=</span> <span class="n">itemid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">itemdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">itemdict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itemdict</span><span class="p">)</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itemdict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="c"># support item attributes</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        itemdict = self._portal.get_item(self.itemid)</span>
<span class="sd">        super().update(itemdict)</span>
<span class="sd">        self.__dict__.update(itemdict)</span>
<span class="sd">        return itemdict[name]</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="c"># support item attributes as dictionary keys on this object</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c">#print(&quot;KeyError:&quot; + k)</span>
            <span class="n">itemdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itemdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itemdict</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

<div class="viewcode-block" id="Item.download"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.download">[docs]</a>    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="p">):</span>
        <span class="n">data_path</span> <span class="o">=</span> <span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span> <span class="o">+</span> <span class="s">&#39;/data&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
            <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span>
        <span class="k">if</span> <span class="n">data_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">download_to_folder</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="nb">dir</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.get_thumbnail"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.get_thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">get_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the bytes that make up the thumbnail for this item.</span>
<span class="sd">        </span>
<span class="sd">        Arguments</span>
<span class="sd">            None.</span>
<span class="sd">            </span>
<span class="sd">        Returns </span>
<span class="sd">            bytes that represent the item.</span>
<span class="sd">            </span>
<span class="sd">        Example</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">        </span>
<span class="sd">            response = item.get_thumbnail()</span>
<span class="sd">            f = open(filename, &#39;wb&#39;)</span>
<span class="sd">            f.write(response)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">if</span> <span class="n">thumbnail_url_path</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">thumbnail_url_path</span><span class="p">,</span> <span class="n">try_json</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="Item.download_thumbnail"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.download_thumbnail">[docs]</a>    <span class="k">def</span> <span class="nf">download_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Downloads the item thumbnail for this item, returns file path. &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>

        <span class="c"># Only proceed if a thumbnail exists</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span>  <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">if</span> <span class="n">thumbnail_url_path</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
                    <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">thumbnail_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span> <span class="c">#If &gt; 50 chars, truncate to last 30 chars</span>
                    <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:]</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">thumbnail_url_path</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">file_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="Item.get_thumbnail_link"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.get_thumbnail_link">[docs]</a>    <span class="k">def</span> <span class="nf">get_thumbnail_link</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; URL to the thumbnail image &quot;&quot;&quot;</span>
        <span class="n">thumbnail_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="n">thumbnail_file</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;http://static.arcgis.com/images/desktopapp.png&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thumbnail_url_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">+</span> <span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span> <span class="o">+</span> <span class="s">&#39;/info/&#39;</span> <span class="o">+</span> <span class="n">thumbnail_file</span>
            <span class="k">return</span> <span class="n">thumbnail_url_path</span>
    </div>
<div class="viewcode-block" id="Item.get_metadata"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the item metadata for the specified item id. &quot;&quot;&quot;</span>
        <span class="n">metadataurlpath</span> <span class="o">=</span> <span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span>  <span class="o">+</span> <span class="s">&#39;/info/metadata/metadata.xml&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metadataurlpath</span><span class="p">,</span> <span class="n">try_json</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c"># If the get operation returns a 400 HTTP Error then the metadata simply</span>
        <span class="c"># doesn&#39;t exist, let&#39;s just return None in this case</span>
        <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">400</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">500</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
</div>
<div class="viewcode-block" id="Item.download_metadata"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.download_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">download_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Downloads the item metadata for the specified item id, returns file path. &quot;&quot;&quot;</span>
        <span class="n">metadataurlpath</span> <span class="o">=</span> <span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span> <span class="o">+</span> <span class="s">&#39;/info/metadata/metadata.xml&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
            <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workdir</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="s">&#39;metadata.xml&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">metadataurlpath</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">filepath</span>

        <span class="c"># If the get operation returns a 400 HTTP/IO Error then the metadata</span>
        <span class="c"># simply doesn&#39;t exist, let&#39;s just return None in this case</span>
        <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">400</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">500</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
</div>
    <span class="k">def</span> <span class="nf">_get_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;web map&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;maps16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;web scene&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;webscene16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;cityengine web scene&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;webscene16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;pro map&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;mapsgray16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;feature service&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;featureshosted16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;map service&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;mapimages16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;image service&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;imagery16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;kml&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;features16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;wms&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;mapimages16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;feature collection&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;features16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;feature collection template&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;maps16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;geodata service&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;layers16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;globe service&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;layers16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;shapefile&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;datafiles16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;web map application&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;apps16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;map package&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;mapsgray16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;feature layer&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;featureshosted16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;map service&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;maptiles16.png&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;map document&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;mapsgray16.png&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;layers16.png&quot;</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">is_logged_in</span><span class="p">():</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_thumbnail_link</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_thumbnail</span><span class="p">())</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="s">&quot;data:image/png;base64,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b64</span><span class="p">,</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&#39; width=&#39;200&#39; height=&#39;133&quot;</span>
        
        <span class="n">snippet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">snippet</span>
        <span class="k">if</span> <span class="n">snippet</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">snippet</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

        <span class="n">portalurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">url</span>  <span class="o">+</span> <span class="s">&quot;/home/item.html?id=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span>

        <span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="n">numViews</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numViews</span><span class="p">,</span> <span class="n">grouping</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;&quot;&quot;&lt;div class=&quot;item_container&quot; style=&quot;height: auto; overflow: hidden; border: 1px solid #cfcfcf; border-radius: 2px; background: #f6fafa; line-height: 1.21429em; padding: 10px;&quot;&gt;</span>
<span class="s">                    &lt;div class=&quot;item_left&quot; style=&quot;width: 210px; float: left;&quot;&gt;</span>
<span class="s">                       &lt;a href=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">portalurl</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; target=&#39;_blank&#39;&gt;</span>
<span class="s">                        &lt;img src=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">thumbnail</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; class=&quot;itemThumbnail&quot;&gt;</span>
<span class="s">                       &lt;/a&gt;</span>
<span class="s">                    &lt;/div&gt;</span>
<span class="s">        </span>
<span class="s">                    &lt;div class=&quot;item_right&quot;     style=&quot;float: none; width: auto; overflow: hidden;&quot;&gt;</span>
<span class="s">                        &lt;a href=&#39;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">portalurl</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&#39; target=&#39;_blank&#39;&gt;&lt;b&gt;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&lt;/b&gt;</span>
<span class="s">                        &lt;/a&gt;</span>
<span class="s">                        &lt;br&gt;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">snippet</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;&lt;img src=&#39;http://www.arcgis.com/home/js/jsapi/esri/css/images/item_type_icons/&quot;&quot;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_icon</span><span class="p">()</span> <span class="o">+</span><span class="s">&quot;&quot;&quot;&#39; style=&quot;vertical-align:middle;&quot;&gt;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot; by &quot;&quot;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;Last Modified: &quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modified</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%B </span><span class="si">%d</span><span class="s">, %Y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">                        &lt;br&gt;&quot;&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numComments</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot; comments, &quot;&quot;&quot;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">numViews</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&quot;&quot; views</span>
<span class="s">                    &lt;/div&gt;</span>
<span class="s">                &lt;/div&gt;</span>
<span class="s">                &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;   </span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&lt;</span><span class="si">%s</span><span class="s"> title:&quot;</span><span class="si">%s</span><span class="s">&quot; type:</span><span class="si">%s</span><span class="s"> owner:</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>

<div class="viewcode-block" id="Item.reassign_to"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.reassign_to">[docs]</a>    <span class="k">def</span> <span class="nf">reassign_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_owner</span><span class="p">,</span> <span class="n">target_folder</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Allows the administrator to reassign a single item from one user to another.</span>

<span class="sd">	    .. note::</span>
<span class="sd">             	If you wish to move all of a user&#39;s items (and groups) to another user then use the</span>
<span class="sd">                user.reassign_to() method.  This method only moves one item at a time.</span>

<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        item_id           required string, unique identifier for the item</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        target_owner      required string, desired owner of the item</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        target_folder     optional string, folder to move the item to.</span>
<span class="sd">        ================  ========================================================</span>

<span class="sd">        :return:</span>
<span class="sd">            a boolean, indicating success</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">current_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ownerFolder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">current_folder</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">reassign_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">target_owner</span><span class="p">,</span> <span class="n">current_folder</span><span class="p">,</span> <span class="n">target_folder</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="Item.share"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.share">[docs]</a>    <span class="k">def</span> <span class="nf">share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">everyone</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">org</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Shares an item with the specified list of groups</span>
<span class="sd">        </span>
<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        everyone          optional boolean, share with everyone</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        org               optional boolean, share with the organization</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        groups            optional string, </span>
<span class="sd">                          comma-separated list of group IDs with which the item will be shared.</span>
<span class="sd">        ================  ========================================================</span>
<span class="sd">            </span>
<span class="sd">        :return:</span>
<span class="sd">            dict with key &quot;notSharedWith&quot; containing array of groups with which the item could not be shared.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ownerFolder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">share_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">everyone</span><span class="p">,</span> <span class="n">org</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.unshare"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.unshare">[docs]</a>    <span class="k">def</span> <span class="nf">unshare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Stops sharing the item with the specified list of groups</span>
<span class="sd">        </span>
<span class="sd">        ================  ========================================================</span>
<span class="sd">        **Argument**      **Description**</span>
<span class="sd">        ----------------  --------------------------------------------------------</span>
<span class="sd">        groups            optional string, </span>
<span class="sd">                          comma-separated list of group IDs with which the item will be unshared.</span>
<span class="sd">        ================  ========================================================</span>
<span class="sd">            </span>
<span class="sd">        :return:</span>
<span class="sd">            dict with key &quot;notUnsharedFrom&quot; containing array of groups from which the item could not be unshared.</span>


<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ownerFolder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">unshare_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.delete"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Deletes an item.</span>
<span class="sd">            </span>
<span class="sd">        :return:</span>
<span class="sd">            a boolean, indicating success</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ownerFolder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">delete_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.update"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_properties</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">thumbnail</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates an item in a Portal.  </span>
<span class="sd">	</span>
<span class="sd">        </span>
<span class="sd">        .. note:: </span>
<span class="sd">            That content can be a file (such as a layer package, geoprocessing package,</span>
<span class="sd">            map package) or it can be a URL (to an ArcGIS Server service, WMS service,</span>
<span class="sd">            or an application).</span>

<span class="sd">            If you are uploading a package or other file, provide a path or URL</span>
<span class="sd">            to the file in the data argument.</span>

<span class="sd">            Only pass in arguments for properties you want to update.</span>
<span class="sd">            All other properties will be left as they are.  If you </span>
<span class="sd">            want to update description, then only provide</span>
<span class="sd">            the description argument in item_properties.</span>

<span class="sd">        </span>
<span class="sd">        ============     ====================================================</span>
<span class="sd">        **Argument**     **Description**</span>
<span class="sd">        ------------     ----------------------------------------------------</span>
<span class="sd">        item_properties  optional dictionary, see below for the keys and values</span>
<span class="sd">        ------------     ----------------------------------------------------</span>
<span class="sd">        data             optional string, either a path or URL to the data</span>
<span class="sd">        ------------     ----------------------------------------------------</span>
<span class="sd">        thumbnail        optional string, either a path or URL to an image</span>
<span class="sd">        ------------     ----------------------------------------------------</span>
<span class="sd">        metadata         optional string, either a path or URL to metadata</span>
<span class="sd">        ============     ====================================================</span>


<span class="sd">        ================  ============================================================================</span>
<span class="sd">         **Key**           **Value**</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        type              optional string, indicates type of item.  See URL 1 below for valid values.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        typeKeywords      optinal string list.  Lists all sub-types.  See URL 1 for valid values.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        description       optional string.  Description of the item.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        title             optional string.  Name of the item.  </span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        url               optional string.  URL to item that are based on URLs.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        tags              optional string of comma-separated values.  Used for searches on items.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        snippet           optional string.  Provides a very short summary of the what the item is.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        extent            optional string with comma separated values for min x, min y, max x, max y.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        spatialReference  optional string.  Coordinate system that the item is in.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        accessInformation optional string.  Information on the source of the content.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        licenseInfo       optinal string, any license information or restrictions regarding the content.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        culture           optional string.  Locale, country and language information.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        access            optional string.  Valid values: private, shared, org, or public.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        commentsEnabled   optional boolean.  Default is true.  Controls whether comments are allowed.</span>
<span class="sd">        ----------------  ----------------------------------------------------------------------------</span>
<span class="sd">        culture           optional string.  Language and country information.</span>
<span class="sd">        ================  ============================================================================</span>

<span class="sd">            </span>
<span class="sd">	URL 1: http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000ms000000</span>

<span class="sd">        :return:</span>
<span class="sd">             a boolean, that indicates success.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ownerFolder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">update_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="n">item_properties</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.get_data"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">try_json</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the data for the item. Returns a dict if try_json is True. To convert this </span>
<span class="sd">        dict to string using json.dumps(data). Else, returns the data</span>
<span class="sd">        as a byte array, that can be converted to string using data.decode(&#39;utf-8&#39;)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_item_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="n">try_json</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="Item.dependent_upon"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.dependent_upon">[docs]</a>    <span class="k">def</span> <span class="nf">dependent_upon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns items and urls, etc that this items depends upon  &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_item_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.dependent_to"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.dependent_to">[docs]</a>    <span class="k">def</span> <span class="nf">dependent_to</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns items and urls, etc dependend upon this item. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">get_item_dependents_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">)</span>
</div>
    <span class="n">_RELATIONSHIP_TYPES</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s">&#39;Map2Service&#39;</span><span class="p">,</span> <span class="s">&#39;WMA2Code&#39;</span><span class="p">,</span>
                                <span class="s">&#39;Map2FeatureCollection&#39;</span><span class="p">,</span> <span class="s">&#39;MobileApp2Code&#39;</span><span class="p">,</span> <span class="s">&#39;Service2Data&#39;</span><span class="p">,</span>
                                <span class="s">&#39;Service2Service&#39;</span><span class="p">])</span>

    <span class="n">_RELATIONSHIP_DIRECTIONS</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s">&#39;forward&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span><span class="p">])</span>

<div class="viewcode-block" id="Item.related_items"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.related_items">[docs]</a>    <span class="k">def</span> <span class="nf">related_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_type</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s">&quot;forward&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns items related to this item. Relationsships can be added and deleted using item.add_relationship() and item.delete_relationship() respectively.</span>
<span class="sd">        rel_type is one of [&#39;Map2Service&#39;, &#39;WMA2Code&#39;, &#39;Map2FeatureCollection&#39;, &#39;MobileApp2Code&#39;, &#39;Service2Data&#39;, &#39;Service2Service&#39;]</span>
<span class="sd">        direction is one of [&#39;forward&#39;, &#39;reverse&#39;] &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rel_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RELATIONSHIP_TYPES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s">&#39;Unsupported relationship type: &#39;</span> <span class="o">+</span> <span class="n">rel_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">direction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RELATIONSHIP_DIRECTIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s">&#39;Unsupported direction: &#39;</span> <span class="o">+</span> <span class="n">direction</span><span class="p">)</span>

        <span class="n">related_items</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;f&#39;</span> <span class="p">:</span> <span class="s">&#39;json&#39;</span> <span class="p">}</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;relationshipType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_type</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">&#39;content/items/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span> <span class="o">+</span> <span class="s">&#39;/relatedItems&#39;</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">related_item</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;relatedItems&#39;</span><span class="p">]:</span>
            <span class="n">related_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">related_item</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">],</span> <span class="n">related_item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">related_items</span>
</div>
<div class="viewcode-block" id="Item.add_relationship"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.add_relationship">[docs]</a>    <span class="k">def</span> <span class="nf">add_relationship</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_item</span><span class="p">,</span> <span class="n">rel_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a relationship from this item to rel_item.</span>
<span class="sd">        Relationships are not tied to an item. They are directional links from an origin item </span>
<span class="sd">        to a destination item and have a type. The type defines the valid origin and destination</span>
<span class="sd">        item types as well as some rules. See Relationship types in REST API help for more information.</span>
<span class="sd">        Users don&#39;t have to own the items they relate unless so defined by the rules of the </span>
<span class="sd">        relationship type.</span>
<span class="sd">        Users can only delete relationships they create.</span>
<span class="sd">        Relationships are deleted automatically if one of the two items is deleted.</span>
<span class="sd">        </span>
<span class="sd">        rel_item is the related item</span>
<span class="sd">        rel_type is one of [&#39;Map2Service&#39;, &#39;WMA2Code&#39;, &#39;Map2FeatureCollection&#39;, &#39;MobileApp2Code&#39;, &#39;Service2Data&#39;, &#39;Service2Service&#39;]. See Relationship types in REST API help for more information on this parameter</span>
<span class="sd">        Returns True if the relationship was added</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rel_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RELATIONSHIP_TYPES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s">&#39;Unsupported relationship type: &#39;</span> <span class="o">+</span> <span class="n">rel_type</span><span class="p">)</span>

        <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;f&#39;</span> <span class="p">:</span> <span class="s">&#39;json&#39;</span> <span class="p">}</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;originItemId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;destinationItemId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_item</span><span class="o">.</span><span class="n">itemid</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;relationshipType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_type</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s">&#39;content/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span>

        <span class="n">path</span> <span class="o">+=</span> <span class="s">&#39;/addRelationship&#39;</span>
        <span class="k">print</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;success&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.delete_relationship"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.delete_relationship">[docs]</a>    <span class="k">def</span> <span class="nf">delete_relationship</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_item</span><span class="p">,</span> <span class="n">rel_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Deletes a relationship between this item and the rel_item. </span>
<span class="sd">        rel_item is the related item</span>
<span class="sd">        rel_type is one of [&#39;Map2Service&#39;, &#39;WMA2Code&#39;, &#39;Map2FeatureCollection&#39;, &#39;MobileApp2Code&#39;, &#39;Service2Data&#39;, &#39;Service2Service&#39;]</span>
<span class="sd">        Returns True if the relationship was deleted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rel_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RELATIONSHIP_TYPES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s">&#39;Unsupported relationship type: &#39;</span> <span class="o">+</span> <span class="n">rel_type</span><span class="p">)</span>
        <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;f&#39;</span> <span class="p">:</span> <span class="s">&#39;json&#39;</span> <span class="p">}</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;originItemId&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;destinationItemId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_item</span><span class="o">.</span><span class="n">itemid</span>
        <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;relationshipType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_type</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s">&#39;content/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span>
        
        
        <span class="n">path</span> <span class="o">+=</span> <span class="s">&#39;/deleteRelationship&#39;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;success&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Item.publish"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.Item.publish">[docs]</a>    <span class="k">def</span> <span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">publish_parameters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">address_fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Publishes a hosted service based on an existing source item (this item).</span>
<span class="sd">        Publishers can create feature services as well as tiled map services.</span>
<span class="sd">        Feature services can be created using input files of type csv, shapefile, serviceDefinition, featureCollection, and fileGeodatabase.</span>
<span class="sd">        CSV files that contain location fields, (ie.address fields or X, Y fields) are spatially enabled during the process of publishing.</span>
<span class="sd">        Shapefiles and file geodatabases should be packaged as *.zip files.</span>
<span class="sd">        Tiled map services can be created from service definition (*.sd) files, tile packages, and existing feature services.</span>
<span class="sd">        Service definitions are authored in ArcGIS for Desktop and contain both the cartographic definition for a map as well as its packaged data together with the definition of the geo-service to be created.</span>
<span class="sd">        address_fields : dict containing mapping of df columns to address fields, eg: { &quot;CountryCode&quot; : &quot;Country&quot;} or { &quot;Address&quot; : &quot;Address&quot; } </span>

<span class="sd">        &quot;&quot;&quot;</span>
        
       
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Service Definition&#39;</span><span class="p">:</span>
           <span class="n">fileType</span> <span class="o">=</span> <span class="s">&#39;serviceDefinition&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Feature Collection&#39;</span><span class="p">:</span>
           <span class="n">fileType</span> <span class="o">=</span> <span class="s">&#39;featureCollection&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;CSV&#39;</span><span class="p">:</span>
           <span class="n">fileType</span> <span class="o">=</span> <span class="s">&#39;CSV&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Shapefile&#39;</span><span class="p">:</span>
           <span class="n">fileType</span> <span class="o">=</span> <span class="s">&#39;shapefile&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;File Geodatabase&#39;</span><span class="p">:</span>
           <span class="n">fileType</span> <span class="o">=</span> <span class="s">&#39;fileGeodatabase&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ownerFolder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="k">if</span> <span class="n">publish_parameters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fileType</span> <span class="o">==</span> <span class="s">&#39;shapefile&#39;</span><span class="p">:</span>
                <span class="n">publish_parameters</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;hasStaticData&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span> <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;maxRecordCount&quot;</span><span class="p">:</span><span class="mi">2000</span><span class="p">,</span> <span class="s">&quot;layerInfo&quot;</span><span class="p">:{</span><span class="s">&quot;capabilities&quot;</span><span class="p">:</span><span class="s">&quot;Query&quot;</span><span class="p">}</span> <span class="p">}</span>
            <span class="k">elif</span> <span class="n">fileType</span> <span class="o">==</span> <span class="s">&#39;CSV&#39;</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;content/features/analyze&quot;</span>

                <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s">&quot;f&quot;</span><span class="p">:</span> <span class="s">&quot;pjson&quot;</span><span class="p">,</span>
                    <span class="s">&quot;itemid&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span>
                    <span class="s">&quot;filetype&quot;</span> <span class="p">:</span> <span class="s">&quot;csv&quot;</span><span class="p">,</span>

                    <span class="s">&quot;analyzeParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&quot;enableGlobalGeocoding&quot;</span><span class="p">:</span> <span class="s">&quot;true&quot;</span><span class="p">,</span>
                        <span class="s">&quot;sourceLocale&quot;</span><span class="p">:</span><span class="s">&quot;en-us&quot;</span><span class="p">,</span>
                        <span class="c">#&quot;locationType&quot;:&quot;address&quot;,</span>
                        <span class="s">&quot;sourceCountry&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                        <span class="s">&quot;sourceCountryHint&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="n">address_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">postdata</span><span class="p">[</span><span class="s">&#39;analyzeParameters&#39;</span><span class="p">][</span><span class="s">&#39;locationType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;address&#39;</span>

                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">postdata</span><span class="p">)</span>
                <span class="n">publish_parameters</span> <span class="o">=</span>  <span class="n">res</span><span class="p">[</span><span class="s">&#39;publishParameters&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">address_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">publish_parameters</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;addressFields&quot;</span><span class="p">:</span><span class="n">address_fields</span><span class="p">})</span>
                <span class="n">publish_parameters</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">publish_parameters</span><span class="p">)</span>
                
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">publish_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemid</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">fileType</span><span class="p">,</span> <span class="n">publish_parameters</span><span class="p">,</span> <span class="n">output_type</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>
        
        <span class="c">#svc_id = ret[0][&#39;serviceItemId&#39;]</span>
        <span class="c">#return Item(self._portal, svc_id)</span>
        
        <span class="n">job_id</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;jobId&#39;</span><span class="p">]</span>
        <span class="n">serviceitem_id</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;serviceItemId&#39;</span><span class="p">]</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s">&#39;content/users/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span>
        <span class="k">if</span> <span class="n">folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">folder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s">&#39;/items/&#39;</span> <span class="o">+</span> <span class="n">serviceitem_id</span> <span class="o">+</span> <span class="s">&#39;/status&#39;</span>
        <span class="c">#print(path)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> 
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;jobid&quot;</span> <span class="p">:</span> <span class="n">job_id</span>
                  <span class="p">}</span>
        <span class="n">job_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="c"># Query and report the Analysis job status.</span>
        <span class="c">#</span>
        <span class="n">num_messages</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">job_response</span><span class="p">))</span>
        <span class="k">if</span> <span class="s">&quot;status&quot;</span> <span class="ow">in</span> <span class="n">job_response</span><span class="p">:</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;completed&quot;</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

                <span class="n">job_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                
                <span class="c">#print(str(job_response))</span>
                <span class="k">if</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobFailed&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Job failed.&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobCancelled&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Job cancelled.&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobTimedOut&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Job timed out.&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No job results.&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">serviceitem_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>
</div></div>
<div class="viewcode-block" id="rot13"><a class="viewcode-back" href="../../arcgis.gis.html#arcgis.gis.rot13">[docs]</a><span class="k">def</span> <span class="nf">rot13</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

    <span class="c"># Loop over characters.</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="c"># Convert to number with ord.</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="c"># Shift number back or forward.</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">-=</span> <span class="mi">13</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="mi">13</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;M&#39;</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">-=</span> <span class="mi">13</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="mi">13</span>

        <span class="c"># Append to result.</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="c"># Return transformation.</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Esri.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>