require(["SessionManager","esri/request","dojo/query","esri/urlUtils","dojo/_base/event","dojo/NodeList-manipulate"],function(a,b,c,d,e){function f(a){c("body").append('<iframe src="'+a+'" style="display:none;"></iframe>')}function g(b,c){return esri.request({url:SiteConfig.download_server+"/dms/rest/download/secured/"+b,content:{token:a.token(),folder:c}}).then(function(a){return 200===a.code?a.url:void 0},function(a){})}function h(b,c){if(a.loggedIn()){var d=a.organization&&a.organization.subscriptionInfo?a.organization.subscriptionInfo.type:"Public";g(b,c).then(f),ga("send","event","SDK Downloads","File Download",b),ga("send","event","SDK Downloads","Account Type",d)}else a.redirect("/sign-in",{redirect_uri:window.location.href.replace(window.location.search,"")+"?filename="+b+"&folder="+c})}function i(a){var b=d.urlToObject(window.location.href).query;b&&b.filename&&b.folder&&(h(b.filename,b.folder),history.replaceState({},"",location.pathname))}c(".download-link").on("click",function(a){e.stop(a);var b=c(this),d=b.attr("data-filename")[0],f=b.attr("data-folder")[0];h(d,f)}),i()});